{"version":3,"file":"lieu.cjs","sources":["../src/core/helpers.js","../src/core/const.js","../src/core/index.js"],"sourcesContent":["const helpers = {\r\n    // Checks if passed object is object or not\r\n    isObject: (obj) => {\r\n        return typeof obj === 'object';\r\n    },\r\n\r\n    // Checks if passed object is funcion or not\r\n    isFunction: (func) => {\r\n        return typeof func === 'function';\r\n    },\r\n\r\n    // Returns parsed from JSON object or null\r\n    fromJson: (obj) => {\r\n        try {\r\n            const languagesFromJson = JSON.parse(obj);\r\n\r\n            if (typeof languagesFromJson === 'object') {\r\n                return languagesFromJson;\r\n            } else {\r\n                return null;\r\n            }\r\n        } catch {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    // Return browser language\r\n    getBrowserLang: () => {\r\n        return navigator.language.slice(0, 2);\r\n    },\r\n\r\n    // Check key existing in object\r\n    hasKey: (key, obj) => {\r\n        return Object.keys(obj).indexOf(key) !== -1;\r\n    },\r\n};\r\n\r\nexport default helpers;\r\n","const STORAGE_KEY = 'lieu';\nconst ATTRIBUTE_NAME = 'data-lieu';\nconst DEFAULT_INTERPOLATION_REGEX = /%\\{(.*?)\\}/g;\n\nexport { STORAGE_KEY, ATTRIBUTE_NAME, DEFAULT_INTERPOLATION_REGEX };\n","import helpers from './helpers';\nimport { STORAGE_KEY, ATTRIBUTE_NAME, DEFAULT_INTERPOLATION_REGEX } from './const';\n\n/**\n * @param initialData<Object>\n */\nexport default class Lieu {\n    #isDebug = false; // boolean\n    #initialData = null; // object\n    #languages = null; // object\n    #currentLanguage = null; // object\n    #attributeName; // string\n    #defaultRegex = DEFAULT_INTERPOLATION_REGEX; // regex\n\n    #onSetLang = (newLang, oldLang) => {};\n    #onGetLang = () => {};\n\n    constructor(initialData) {\n        this.#initialData = initialData;\n\n        this.#isDebug = initialData.isDebug;\n\n        this.#init();\n    }\n\n    #init() {\n        this.#initLanguages();\n        this.#setAttributeName();\n        this.#setInitialLanguage();\n        this.#setHooks();\n    }\n\n    // Set class field languages if languages from initial data is object or json\n    #initLanguages() {\n        let initialLanguages = this.#initialData.languages;\n\n        if (!helpers.isObject(initialLanguages)) {\n            initialLanguages = helpers.fromJson(initialLanguages);\n        }\n\n        this.#languages = initialLanguages;\n    }\n\n    // Set hooks if they exist in initial data\n    #setHooks() {\n        if (helpers.isFunction(this.#initialData.onSetLang)) {\n            this.#onSetLang = this.#initialData.onSetLang;\n        }\n\n        if (helpers.isFunction(this.#initialData.onGetLang)) {\n            this.#onGetLang = this.#initialData.onGetLang;\n        }\n    }\n\n    // Set custom data attribute\n    #setAttributeName() {\n        this.#attributeName = this.#initialData.attributeName ?? ATTRIBUTE_NAME;\n    }\n\n    // Set initial language from languages\n    #setInitialLanguage() {\n        const initialLang = this.#initialData.initialLanguage;\n\n        const userKeyLang =\n            localStorage.getItem(STORAGE_KEY) ?? // from storage\n            this.#initialData.initialLanguage ?? // from options\n            helpers.getBrowserLang(); // from userAgent\n\n        if (helpers.hasKey(userKeyLang, this.#languages)) {\n            this.setLang(userKeyLang);\n        } else if (helpers.hasKey(initialLang, this.#languages)) {\n            this.setLang(initialLang);\n        } else {\n            this.setLang(Object.keys(this.#languages)[0]);\n        }\n    }\n\n    /*\n     * Set new lang by string key from languages class field\n     * @param langKey<String>\n     */\n    setLang(langKey) {\n        const newLanguage = this.#languages[langKey];\n        const oldLanguage = this.#currentLanguage;\n\n        if (!helpers.hasKey(langKey, this.#languages)) {\n            console.error(\n                `Lieu | Language key \"${langKey}\" not found in languages!`\n            );\n\n            return;\n        }\n\n        this.#currentLanguage = newLanguage;\n        localStorage.setItem(STORAGE_KEY, langKey);\n\n        this.#localizeDomElems();\n\n        this.#onSetLang(oldLanguage, newLanguage);\n    }\n\n    // Find all data-attributes by attributeName field in DOM, and localize them\n    #localizeDomElems() {\n        const $locales = Array.from(\n            document.querySelectorAll(`[${this.#attributeName}]`)\n        );\n\n        $locales.forEach(($str) => {\n            const locale = $str.getAttribute(this.#attributeName);\n            $str.innerHTML = this.localize(locale);\n        });\n    }\n\n    /**\n     * Return value from currentLanguage.locales or null\n     * @param localeKey<String>\n     * @param options<Object>\n     */\n    localize(localeKey, options) {\n        const { locales } = this.#currentLanguage;\n        let locale = locales[localeKey];\n\n        if (!locale) {\n            locale = localeKey;\n\n            if (this.#isDebug) {\n                console.warn(\n                    `Lieu | Locale key \"${localeKey}\" not found in current language!`\n                );\n            }\n        }\n\n        if (options) {\n            locale = locale.replace(\n                this.#defaultRegex,\n                (match, key) => options[key] || match\n            );\n        }\n\n        return locale;\n    }\n\n    /** Return language object from languages class field by its' key\n    * or current langauge if @param langKey is not set\n    @param langKey<String> not required\n    */\n    getLang(langKey) {\n        this.#onGetLang();\n\n        if (!langKey) {\n            return this.#currentLanguage;\n        }\n\n        if (!helpers.hasKey(langKey, this.#languages)) {\n            console.error(\n                `Lieu | Language key \"${langKey}\" not found in languages!`\n            );\n\n            return;\n        }\n\n        return this.#languages[langKey];\n    }\n\n    // Returns object of all languages\n    getLangs() {\n        return this.#languages;\n    }\n}\n"],"names":["helpers","isObject","obj","isFunction","func","fromJson","languagesFromJson","JSON","parse","getBrowserLang","navigator","language","slice","hasKey","key","Object","keys","indexOf","STORAGE_KEY","ATTRIBUTE_NAME","DEFAULT_INTERPOLATION_REGEX","Lieu","newLang","oldLang","constructor","initialData","isDebug","initialLanguages","languages","onSetLang","onGetLang","attributeName","initialLang","initialLanguage","userKeyLang","localStorage","getItem","setLang","langKey","newLanguage","oldLanguage","console","error","setItem","$locales","Array","from","document","querySelectorAll","forEach","$str","locale","getAttribute","innerHTML","localize","localeKey","options","locales","warn","replace","match","getLang","getLangs"],"mappings":"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"}