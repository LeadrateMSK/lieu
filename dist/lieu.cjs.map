{"version":3,"file":"lieu.cjs","sources":["../src/core/Helpers.js","../src/core/const.js","../src/core/index.js"],"sourcesContent":["class Helpers {\n    // Checks if passed object is object or not\n    static isObject(obj) {\n        return typeof obj === 'object';\n    }\n\n    // Checks if passed object is funcion or not\n    static isFunction(obj) {\n        return typeof obj === 'function';\n    }\n\n    /** Returns parsed from JSON object or null\n    @param obj<JSON>\n    */\n    static fromJson(obj) {\n        try {\n            const languagesFromJson = JSON.parse(obj);\n\n            if (this.isObject(languagesFromJson)) {\n                return languagesFromJson;\n            } else {\n                return null;\n            }\n        } catch {\n            return null;\n        }\n    }\n}\n\nexport default Helpers;\n","const STORAGE_KEY = 'lieu';\nconst ATTRIBUTE_NAME = 'data-lieu';\n\nexport { STORAGE_KEY, ATTRIBUTE_NAME };\n","import Helpers from './Helpers';\nimport { STORAGE_KEY, ATTRIBUTE_NAME } from './const';\n\n/**\n * @param initialData<Object>\n */\nexport default class Lieu {\n    #isDebug = false; // boolean\n    #isPluginInitialized = false; // boolean\n    #initialData = null; // object\n    #languages = null; // object\n    #currentLanguage = null; // object\n    #initialLanguage = null; // string\n    #attributeName = ATTRIBUTE_NAME; // string\n\n    #onSetLang = (newLang, oldLang) => {};\n    #onGetLang = () => {};\n\n    constructor(initialData) {\n        this.#initialData = initialData;\n\n        this.#isDebug = initialData.isDebug;\n\n        this.#initLieu();\n    }\n\n    // Class initialization\n    #initLieu() {\n        this.#initLanguages();\n        this.#setHooks();\n        this.#setAttributeName();\n        this.#setInitialLanguage();\n    }\n\n    // Set class field languages if languages from inittial data is object or json\n    #initLanguages() {\n        let initialLanguages = this.#initialData?.languages;\n\n        if (Helpers.isObject(initialLanguages)) {\n            this.#setLanguages(initialLanguages);\n        } else {\n            initialLanguages = Helpers.fromJson(initialLanguages); // return null if lang not in json\n\n            this.#setLanguages(initialLanguages);\n        }\n    }\n\n    // Set hooks if they exist in inital data\n    #setHooks() {\n        if (Helpers.isFunction(this.#initialData.onSetLang)) {\n            this.#onSetLang = this.#initialData.onSetLang;\n        }\n\n        if (Helpers.isFunction(this.#initialData.onGetLang)) {\n            this.#onGetLang = this.#initialData.onGetLang;\n        }\n    }\n\n    // Set custom data attribute\n    #setAttributeName() {\n        const attr = this.#initialData?.attributeName;\n\n        if (attr) {\n            this.#attributeName = attr;\n        }\n    }\n\n    /** Set languages from initial data in languages class field\n    @param langs<Object>\n    */\n    #setLanguages(langs) {\n        this.#languages = langs;\n    }\n\n    // Set initial language from languages\n    #setInitialLanguage() {\n        const storageLangKey = window.localStorage?.getItem(STORAGE_KEY);\n        const initialLangName = this.#initialData.initialLanguage;\n\n        let defaultLangKey;\n\n        // If storage lang exists in languages object set as default\n        if (storageLangKey) {\n            const isExistsInLangs = this.#isKeyExistsInLangs(storageLangKey);\n\n            // If it exists in languages set as initial\n            if (isExistsInLangs) {\n                defaultLangKey = this.#languages[storageLangKey];\n            }\n        }\n\n        // If storageLangKey not used and browser language exists in languages object sets it as default\n        if (!defaultLangKey) {\n            const browserLang = this.getBrowserLang().slice(0, 2);\n\n            if (browserLang) {\n                const isExistsInLangs = this.#isKeyExistsInLangs(browserLang);\n\n                if (isExistsInLangs) {\n                    defaultLangKey = this.#languages[browserLang];\n                }\n            }\n        }\n\n        // If storageLangKey and browser lang not used, set initialLangName as default\n        if (initialLangName && !defaultLangKey) {\n            const isExistsInLangs = this.#isKeyExistsInLangs(initialLangName);\n\n            // If it exists in languages set as initial\n            if (isExistsInLangs) {\n                defaultLangKey = initialLangName;\n            }\n        } else {\n            // If storageLangKey, browser lang and initialLangName not used, set first language key as default\n            defaultLangKey = Object.keys(this.#languages)[0];\n        }\n\n        this.#initialLanguage = defaultLangKey;\n\n        this.setLang(defaultLangKey);\n    }\n\n    /** Checks is key exists in language object\n    @param langKey<String>\n    returns true if key exists\n    */\n    #isKeyExistsInLangs(langKey) {\n        const langKeys = Object.keys(this.#languages);\n\n        return langKeys.find((key) => key === langKey);\n    }\n\n    /** Set new lang by string key from languages class field\n    @param langKey<String>\n    */\n    setLang(langKey) {\n        const newLanguage = this.#languages[langKey];\n        const oldLanguage = this.#currentLanguage;\n\n        if (!newLanguage) {\n            if (this.#isDebug) {\n                console.error(\n                    `Lieu | Language key \"${langKey}\" not found in languages!`\n                );\n            }\n\n            return;\n        }\n\n        this.#currentLanguage = newLanguage;\n        window.localStorage?.setItem(STORAGE_KEY, langKey);\n\n        this.#localizeDomElems();\n\n        if (this.#isPluginInitialized) {\n            this.#onSetLang(oldLanguage, newLanguage);\n        } else {\n            this.#isPluginInitialized = true;\n        }\n    }\n\n    // Find all data-attributes by attributeName field in DOM, and localize them\n    #localizeDomElems() {\n        const localeElems = Array.from(\n            document.querySelectorAll(`[${this.#attributeName}]`)\n        );\n\n        const { locales } = this.#currentLanguage;\n\n        localeElems.forEach((elem) => {\n            const locale = elem.getAttribute(this.#attributeName);\n\n            let localeText = locales[locale];\n\n            // If not found set attr value as text\n            if (!localeText) {\n                localeText = locale;\n\n                if (this.#isDebug) {\n                    console.warn(\n                        `Lieu | ${\n                            this.#attributeName\n                        } attribute value \"${locale}\" not found in current language!`\n                    );\n                }\n            }\n\n            elem.innerHTML = localeText;\n        });\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    localize(localeKey) {\n        const { locales } = this.#currentLanguage;\n        let locale = locales[localeKey];\n\n        if (!locale) {\n            locale = localeKey;\n\n            if (this.#isDebug) {\n                console.error(\n                    `Lieu | Locale key \"${localeKey}\" not found in current language!`\n                );\n            }\n        }\n\n        return locale;\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    __(localeKey) {\n        return this.localize(localeKey);\n    }\n\n    // Return browser language\n    getBrowserLang() {\n        return navigator?.language;\n    }\n\n    /** Return language object from languages class field by its' key\n    * or current langauge if @param langKey is not set\n    @param langKey<String> not required\n    */\n    getLang(langKey) {\n        this.#onGetLang();\n\n        if (langKey) {\n            return this.#languages[langKey];\n        }\n\n        return this.#currentLanguage;\n    }\n\n    // Returns object of all languages\n    getLangs() {\n        return this.#languages;\n    }\n\n    // Returns string of initial language\n    getInitialLang() {\n        return this.#initialLanguage;\n    }\n}\n"],"names":["Helpers","isObject","obj","isFunction","fromJson","languagesFromJson","JSON","parse","STORAGE_KEY","ATTRIBUTE_NAME","Lieu","newLang","oldLang","constructor","initialData","isDebug","initialLanguages","languages","onSetLang","onGetLang","attr","attributeName","langs","storageLangKey","window","localStorage","getItem","initialLangName","initialLanguage","defaultLangKey","isExistsInLangs","browserLang","getBrowserLang","slice","Object","keys","setLang","langKey","langKeys","find","key","newLanguage","oldLanguage","console","error","setItem","localeElems","Array","from","document","querySelectorAll","locales","forEach","elem","locale","getAttribute","localeText","warn","innerHTML","localize","localeKey","__","navigator","language","getLang","getLangs","getInitialLang"],"mappings":"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"}