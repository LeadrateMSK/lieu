{"version":3,"file":"lieu.min.js","sources":["../src/core/helpers.js","../src/core/const.js","../src/core/index.js"],"sourcesContent":["const helpers = {\r\n    // Checks if passed object is object or not\r\n    isObject: (obj) => {\r\n        return typeof obj === 'object';\r\n    },\r\n\r\n    // Checks if passed object is funcion or not\r\n    isFunction: (func) => {\r\n        return typeof func === 'function';\r\n    },\r\n\r\n    // Returns parsed from JSON object or null\r\n    fromJson: (obj) => {\r\n        try {\r\n            const languagesFromJson = JSON.parse(obj);\r\n\r\n            if (typeof languagesFromJson === 'object') {\r\n                return languagesFromJson;\r\n            } else {\r\n                return null;\r\n            }\r\n        } catch {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    // Return browser language\r\n    getBrowserLang: () => {\r\n        return navigator.language.slice(0, 2);\r\n    },\r\n\r\n    // Check key existing in object\r\n    hasKey: (key, obj) => {\r\n        return Object.keys(obj).indexOf(key) !== -1;\r\n    },\r\n};\r\n\r\nexport default helpers;\r\n","const STORAGE_KEY = 'lieu';\nconst ATTRIBUTE_NAME = 'data-lieu';\nconst DEFAULT_INTERPOLATION_REGEX = /%\\{(.*?)\\}/g;\n\nexport { STORAGE_KEY, ATTRIBUTE_NAME, DEFAULT_INTERPOLATION_REGEX };\n","import helpers from './helpers';\nimport { STORAGE_KEY, ATTRIBUTE_NAME, DEFAULT_INTERPOLATION_REGEX } from './const';\n\n/**\n * @param initialData<Object>\n */\nexport default class Lieu {\n    #isDebug = false; // boolean\n    #initialData = null; // object\n    #languages = null; // object\n    #currentLanguage = null; // object\n    #attributeName; // string\n    #defaultRegex = DEFAULT_INTERPOLATION_REGEX; // regex\n\n    #onSetLang = (newLang, oldLang) => {};\n    #onGetLang = () => {};\n\n    constructor(initialData) {\n        this.#initialData = initialData;\n\n        this.#isDebug = initialData.isDebug;\n\n        this.#init();\n    }\n\n    #init() {\n        this.#initLanguages();\n        this.#setAttributeName();\n        this.#setInitialLanguage();\n        this.#setHooks();\n    }\n\n    // Set class field languages if languages from initial data is object or json\n    #initLanguages() {\n        let initialLanguages = this.#initialData.languages;\n\n        if (!helpers.isObject(initialLanguages)) {\n            initialLanguages = helpers.fromJson(initialLanguages);\n        }\n\n        this.#languages = initialLanguages;\n    }\n\n    // Set hooks if they exist in initial data\n    #setHooks() {\n        if (helpers.isFunction(this.#initialData.onSetLang)) {\n            this.#onSetLang = this.#initialData.onSetLang;\n        }\n\n        if (helpers.isFunction(this.#initialData.onGetLang)) {\n            this.#onGetLang = this.#initialData.onGetLang;\n        }\n    }\n\n    // Set custom data attribute\n    #setAttributeName() {\n        this.#attributeName = this.#initialData.attributeName ?? ATTRIBUTE_NAME;\n    }\n\n    // Set initial language from languages\n    #setInitialLanguage() {\n        const initialLang = this.#initialData.initialLanguage;\n\n        const userKeyLang =\n            localStorage.getItem(STORAGE_KEY) ?? // from storage\n            this.#initialData.initialLanguage ?? // from options\n            helpers.getBrowserLang(); // from userAgent\n\n        if (helpers.hasKey(userKeyLang, this.#languages)) {\n            this.setLang(userKeyLang);\n        } else if (helpers.hasKey(initialLang, this.#languages)) {\n            this.setLang(initialLang);\n        } else {\n            this.setLang(Object.keys(this.#languages)[0]);\n        }\n    }\n\n    /*\n     * Set new lang by string key from languages class field\n     * @param langKey<String>\n     */\n    setLang(langKey) {\n        const newLanguage = this.#languages[langKey];\n        const oldLanguage = this.#currentLanguage;\n\n        if (!helpers.hasKey(langKey, this.#languages)) {\n            console.error(\n                `Lieu | Language key \"${langKey}\" not found in languages!`\n            );\n\n            return;\n        }\n\n        this.#currentLanguage = newLanguage;\n        localStorage.setItem(STORAGE_KEY, langKey);\n\n        this.#localizeDomElems();\n\n        this.#onSetLang(oldLanguage, newLanguage);\n    }\n\n    // Find all data-attributes by attributeName field in DOM, and localize them\n    #localizeDomElems() {\n        const $locales = Array.from(\n            document.querySelectorAll(`[${this.#attributeName}]`)\n        );\n\n        $locales.forEach(($str) => {\n            const locale = $str.getAttribute(this.#attributeName);\n            $str.innerHTML = this.localize(locale);\n        });\n    }\n\n    /**\n     * Return value from currentLanguage.locales or null\n     * @param localeKey<String>\n     * @param options<Object>\n     */\n    localize(localeKey, options) {\n        const { locales } = this.#currentLanguage;\n        let locale = locales[localeKey];\n\n        if (!locale) {\n            locale = localeKey;\n\n            if (this.#isDebug) {\n                console.warn(\n                    `Lieu | Locale key \"${localeKey}\" not found in current language!`\n                );\n            }\n        }\n\n        if (options) {\n            locale = locale.replace(\n                this.#defaultRegex,\n                (match, key) => options[key] || match\n            );\n        }\n\n        return locale;\n    }\n\n    /** Return language object from languages class field by its' key\n    * or current langauge if @param langKey is not set\n    @param langKey<String> not required\n    */\n    getLang(langKey) {\n        this.#onGetLang();\n\n        if (!langKey) {\n            return this.#currentLanguage;\n        }\n\n        if (!helpers.hasKey(langKey, this.#languages)) {\n            console.error(\n                `Lieu | Language key \"${langKey}\" not found in languages!`\n            );\n\n            return;\n        }\n\n        return this.#languages[langKey];\n    }\n\n    // Returns object of all languages\n    getLangs() {\n        return this.#languages;\n    }\n}\n"],"names":["helpers","obj","func","languagesFromJson","JSON","parse","navigator","language","slice","key","Object","keys","indexOf","STORAGE_KEY","DEFAULT_INTERPOLATION_REGEX","isDebug","initialData","languages","currentLanguage","attributeName","defaultRegex","onSetLang","newLang","oldLang","onGetLang","constructor","this","init","initLanguages","setAttributeName","setInitialLanguage","setHooks","initialLanguages","initialLang","initialLanguage","userKeyLang","localStorage","getItem","setLang","langKey","newLanguage","oldLanguage","setItem","localizeDomElems","console","error","Array","from","document","querySelectorAll","forEach","$str","locale","getAttribute","innerHTML","localize","localeKey","options","locales","warn","replace","match","getLang","getLangs"],"mappings":";;;;;qOAAA,MAAMA,EAESC,GACe,iBAARA,EAHhBD,EAOWE,GACc,mBAATA,EARhBF,EAYSC,IACP,IACI,MAAME,EAAoBC,KAAKC,MAAMJ,GAErC,MAAiC,iBAAtBE,EACAA,EAEA,IAId,CAFC,MACE,OAAO,IACV,GAvBHH,EA2Bc,IACLM,UAAUC,SAASC,MAAM,EAAG,GA5BrCR,EAgCM,CAACS,EAAKR,KACgC,IAAnCS,OAAOC,KAAKV,GAAKW,QAAQH,GCjClCI,EAAc,OAEdC,EAA8B,qBCIrB,MACXC,IAAW,EACXC,GAAe,KACfC,GAAa,KACbC,GAAmB,KACnBC,GACAC,GAAgBN,EAEhBO,GAAa,CAACC,EAASC,KAAV,EACbC,GAAa,OAEbC,YAAYT,GACRU,MAAKV,EAAeA,EAEpBU,MAAKX,EAAWC,EAAYD,QAE5BW,MAAKC,GACR,CAEDA,KACID,MAAKE,IACLF,MAAKG,IACLH,MAAKI,IACLJ,MAAKK,GAvBa,CA2BtBH,KACI,IAAII,EAAmBN,MAAKV,EAAaC,UAEpCjB,EAAiBgC,KAClBA,EAAmBhC,EAAiBgC,IAGxCN,MAAKT,EAAae,CAlCA,CAsCtBD,KACQ/B,EAAmB0B,MAAKV,EAAaK,aACrCK,MAAKL,EAAaK,MAAKV,EAAaK,WAGpCrB,EAAmB0B,MAAKV,EAAaQ,aACrCE,MAAKF,EAAaE,MAAKV,EAAaQ,UA5CtB,CAiDtBK,KACIH,MAAKP,EAAiBO,MAAKV,EAAaG,eDvDzB,WCKG,CAsDtBW,KACI,MAAMG,EAAcP,MAAKV,EAAakB,gBAEhCC,EACFC,aAAaC,QAAQxB,IACrBa,MAAKV,EAAakB,iBAClBlC,IAEAA,EAAemC,EAAaT,MAAKT,GACjCS,KAAKY,QAAQH,GACNnC,EAAeiC,EAAaP,MAAKT,GACxCS,KAAKY,QAAQL,GAEbP,KAAKY,QAAQ5B,OAAOC,KAAKe,MAAKT,GAAY,GAEjD,CAMDqB,QAAQC,GACJ,MAAMC,EAAcd,MAAKT,EAAWsB,GAC9BE,EAAcf,MAAKR,EAEpBlB,EAAeuC,EAASb,MAAKT,IAQlCS,MAAKR,EAAmBsB,EACxBJ,aAAaM,QAAQ7B,EAAa0B,GAElCb,MAAKiB,IAELjB,MAAKL,EAAWoB,EAAaD,IAZzBI,QAAQC,MACH,wBAAuBN,6BAjFd,CAgGtBI,KACqBG,MAAMC,KACnBC,SAASC,iBAAkB,IAAGvB,MAAKP,OAG9B+B,SAASC,IACd,MAAMC,EAASD,EAAKE,aAAa3B,MAAKP,GACtCgC,EAAKG,UAAY5B,KAAK6B,SAASH,EAA/B,GAEP,CAODG,SAASC,EAAWC,GAChB,MAAMC,QAAEA,GAAYhC,MAAKR,EACzB,IAAIkC,EAASM,EAAQF,GAmBrB,OAjBKJ,IACDA,EAASI,EAEL9B,MAAKX,GACL6B,QAAQe,KACH,sBAAqBH,sCAK9BC,IACAL,EAASA,EAAOQ,QACZlC,MAAKN,GACL,CAACyC,EAAOpD,IAAQgD,EAAQhD,IAAQoD,KAIjCT,CACV,CAMDU,QAAQvB,GAGJ,OAFAb,MAAKF,IAEAe,EAIAvC,EAAeuC,EAASb,MAAKT,GAQ3BS,MAAKT,EAAWsB,QAPnBK,QAAQC,MACH,wBAAuBN,8BALrBb,MAAKR,CAhJE,CA+JtB6C,WACI,OAAOrC,MAAKT,CACf"}