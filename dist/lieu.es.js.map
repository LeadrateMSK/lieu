{"version":3,"file":"lieu.es.js","sources":["../src/core/Helpers.js","../src/core/const.js","../src/core/index.js"],"sourcesContent":["class Helpers {\n    // Checks if passed data is object or not\n    static isObject(data) {\n        return typeof data === 'object';\n    }\n\n    /** Returns parsed from JSON object or null\n    @param data<JSON>\n    */\n    static fromJson(data) {\n        try {\n            const languagesFromJson = JSON.parse(data);\n\n            if (this.isObject(languagesFromJson)) {\n                return languagesFromJson;\n            } else {\n                return null;\n            }\n        } catch {\n            return null;\n        }\n    }\n}\n\nexport default Helpers;\n","const STORAGE_KEY = 'language';\n\nexport { STORAGE_KEY };\n","import Helpers from './Helpers';\nimport { STORAGE_KEY } from './const';\n\n/**\n * @param initialData<Object>\n */\nexport default class Lieu {\n    initialData;\n    languages = null;\n    initialLanguage = null;\n    currentLanguage = null;\n    attributeName = 'data-localize';\n\n    onSetLang = (newLang, oldLang) => {};\n    onGetLang = () => {};\n\n    constructor(initialData) {\n        this.initialData = initialData;\n\n        this.initLieu();\n    }\n\n    // Class initialization\n    initLieu() {\n        this.initLanguages();\n        this.setHooks();\n        this.setAttributeName();\n        this.setInitialLanguage();\n    }\n\n    // Set class field languages if languages from inittial data is object or json\n    initLanguages() {\n        let initialLanguages = this.initialData?.languages;\n\n        if (Helpers.isObject(initialLanguages)) {\n            this.setLanguages(initialLanguages);\n        } else {\n            initialLanguages = Helpers.fromJson(initialLanguages); // return null if lang not in json\n\n            this.setLanguages(initialLanguages);\n        }\n    }\n\n    // Set hooks if they exist in inital data\n    setHooks() {\n        if (typeof this.initialData.onSetLang === 'function') {\n            this.onSetLang = this.initialData.onSetLang;\n        }\n\n        if (typeof this.initialData.onGetLang === 'function') {\n            this.onGetLang = this.initialData.onGetLang;\n        }\n    }\n\n    // Set custom data attribute\n    setAttributeName() {\n        const attr = this.initialData?.attributeName;\n\n        if (attr) {\n            this.attributeName = attr;\n        }\n    }\n\n    /** Set languages from initial data in languages class field\n    @param langs<Object>\n    */\n    setLanguages(langs) {\n        this.languages = langs;\n    }\n\n    // Set initial language from languages\n    setInitialLanguage() {\n        const langKeys = Object.keys(this.languages);\n        const initialLangName = this.initialData.initialLanguage;\n\n        if (initialLangName) {\n            for (let i = 0; i < langKeys.length; i++) {\n                if (initialLangName.includes(langKeys[i])) {\n                    this.initialLanguage = this.languages[langKeys[i]];\n\n                    this.setLang(initialLangName);\n\n                    break;\n                }\n            }\n        } else {\n            this.setInitialLanguageAuto();\n        }\n    }\n\n    // Set initial language if initial language is not set in initial data\n    setInitialLanguageAuto() {\n        // Todo improve\n        const storageLangKey = window.localStorage?.getItem(STORAGE_KEY);\n        const langKeys = Object.keys(this.languages);\n        let langKey = langKeys[0];\n\n        if (storageLangKey) {\n            for (let i = 0; i < langKeys.length; i++) {\n                if (langKeys[i] === storageLangKey) {\n                    langKey = storageLangKey;\n                    break;\n                }\n            }\n        }\n\n        this.initialLanguage = this.languages[langKey];\n\n        this.setLang(langKey);\n    }\n\n    /** Set new lang by string key from languages class field\n    @param langKey<String>\n    */\n    setLang(langKey) {\n        const oldLang = this.currentLanguage;\n\n        this.currentLanguage = this.languages[langKey];\n        window.localStorage?.setItem(STORAGE_KEY, langKey);\n\n        this.localizeDomElems();\n\n        this.onSetLang(oldLang, this.currentLanguage);\n    }\n\n    // Find all data-attributes by attributeName field in DOM, and localize them\n    localizeDomElems() {\n        const localeElems = Array.from(\n            document.querySelectorAll(`[${this.attributeName}]`)\n        );\n\n        const { locales } = this.currentLanguage;\n\n        localeElems.forEach((elem) => {\n            const locale = elem.getAttribute(this.attributeName);\n\n            const localeText = locales[locale];\n\n            elem.innerHTML = localeText;\n        });\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    localize(localeKey) {\n        const { locales } = this.currentLanguage;\n\n        return locales[localeKey];\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    __(localeKey) {\n        return this.localize(localeKey);\n    }\n\n    // Return browser language\n    getBrowserLang() {\n        return navigator?.language;\n    }\n\n    /** Return language object from languages class field by its' key\n    * or current langauge if @param langKey is not set\n    @param langKey<String> not required\n    */\n    getLang(langKey) {\n        this.onGetLang();\n\n        if (langKey) {\n            return this.languages[langKey];\n        }\n\n        return this.currentLanguage;\n    }\n\n    // Returns object of all languages\n    getLangs() {\n        return this.languages;\n    }\n}\n"],"names":["Helpers","isObject","data","fromJson","languagesFromJson","JSON","parse","STORAGE_KEY","Lieu","initialData","languages","initialLanguage","currentLanguage","attributeName","onSetLang","newLang","oldLang","onGetLang","constructor","initLieu","initLanguages","setHooks","setAttributeName","setInitialLanguage","initialLanguages","setLanguages","attr","langs","langKeys","Object","keys","initialLangName","i","length","includes","setLang","setInitialLanguageAuto","storageLangKey","window","localStorage","getItem","langKey","setItem","localizeDomElems","localeElems","Array","from","document","querySelectorAll","locales","forEach","elem","locale","getAttribute","localeText","innerHTML","localize","localeKey","__","getBrowserLang","navigator","language","getLang","getLangs"],"mappings":"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"}