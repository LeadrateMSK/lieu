{"version":3,"file":"lieu.js","sources":["../src/core/Helpers.js","../src/core/const.js","../src/core/index.js"],"sourcesContent":["class Helpers {\n    // Checks if passed object is object or not\n    static isObject(obj) {\n        return typeof obj === 'object';\n    }\n\n    // Checks if passed object is funcion or not\n    static isFunction(obj) {\n        return typeof obj === 'function';\n    }\n\n    /** Returns parsed from JSON object or null\n    @param obj<JSON>\n    */\n    static fromJson(obj) {\n        try {\n            const languagesFromJson = JSON.parse(obj);\n\n            if (this.isObject(languagesFromJson)) {\n                return languagesFromJson;\n            } else {\n                return null;\n            }\n        } catch {\n            return null;\n        }\n    }\n}\n\nexport default Helpers;\n","const STORAGE_KEY = 'lieu';\nconst ATTRIBUTE_NAME = 'data-lieu';\n\nexport { STORAGE_KEY, ATTRIBUTE_NAME };\n","import Helpers from './Helpers';\nimport { STORAGE_KEY, ATTRIBUTE_NAME } from './const';\n\n/**\n * @param initialData<Object>\n */\nexport default class Lieu {\n    #isDebug = false; // boolean\n    #isPluginInitialized = false; // boolean\n    #initialData = null; // object\n    #languages = null; // object\n    #currentLanguage = null; // object\n    #initialLanguage = null; // string\n    #attributeName = ATTRIBUTE_NAME; // string\n\n    #onSetLang = (newLang, oldLang) => {};\n    #onGetLang = () => {};\n\n    constructor(initialData) {\n        this.#initialData = initialData;\n\n        this.#isDebug = initialData.isDebug;\n\n        this.#initLieu();\n    }\n\n    // Class initialization\n    #initLieu() {\n        this.#initLanguages();\n        this.#setHooks();\n        this.#setAttributeName();\n        this.#setInitialLanguage();\n    }\n\n    // Set class field languages if languages from inittial data is object or json\n    #initLanguages() {\n        let initialLanguages = this.#initialData?.languages;\n\n        if (Helpers.isObject(initialLanguages)) {\n            this.#setLanguages(initialLanguages);\n        } else {\n            initialLanguages = Helpers.fromJson(initialLanguages); // return null if lang not in json\n\n            this.#setLanguages(initialLanguages);\n        }\n    }\n\n    // Set hooks if they exist in inital data\n    #setHooks() {\n        if (Helpers.isFunction(this.#initialData.onSetLang)) {\n            this.#onSetLang = this.#initialData.onSetLang;\n        }\n\n        if (Helpers.isFunction(this.#initialData.onGetLang)) {\n            this.#onGetLang = this.#initialData.onGetLang;\n        }\n    }\n\n    // Set custom data attribute\n    #setAttributeName() {\n        const attr = this.#initialData?.attributeName;\n\n        if (attr) {\n            this.#attributeName = attr;\n        }\n    }\n\n    /** Set languages from initial data in languages class field\n    @param langs<Object>\n    */\n    #setLanguages(langs) {\n        this.#languages = langs;\n    }\n\n    // Set initial language from languages\n    #setInitialLanguage() {\n        const storageLangKey = window.localStorage?.getItem(STORAGE_KEY);\n        const initialLangName = this.#initialData.initialLanguage;\n\n        let defaultLangKey;\n\n        // If storage lang exists in languages object set as default\n        if (storageLangKey) {\n            const isExistsInLangs = this.#isKeyExistsInLangs(storageLangKey);\n\n            // If it exists in languages set as initial\n            if (isExistsInLangs) {\n                defaultLangKey = this.#languages[storageLangKey];\n            }\n        }\n\n        // If storageLangKey not used and browser language exists in languages object sets it as default\n        if (!defaultLangKey) {\n            const browserLang = this.getBrowserLang().slice(0, 2);\n\n            if (browserLang) {\n                const isExistsInLangs = this.#isKeyExistsInLangs(browserLang);\n\n                if (isExistsInLangs) {\n                    defaultLangKey = this.#languages[browserLang];\n                }\n            }\n        }\n\n        // If storageLangKey and browser lang not used, set initialLangName as default\n        if (initialLangName && !defaultLangKey) {\n            const isExistsInLangs = this.#isKeyExistsInLangs(initialLangName);\n\n            // If it exists in languages set as initial\n            if (isExistsInLangs) {\n                defaultLangKey = initialLangName;\n            }\n        } else {\n            // If storageLangKey, browser lang and initialLangName not used, set first language key as default\n            defaultLangKey = Object.keys(this.#languages)[0];\n        }\n\n        this.#initialLanguage = defaultLangKey;\n\n        this.setLang(defaultLangKey);\n    }\n\n    /** Checks is key exists in language object\n    @param langKey<String>\n    returns true if key exists\n    */\n    #isKeyExistsInLangs(langKey) {\n        const langKeys = Object.keys(this.#languages);\n\n        return langKeys.find((key) => key === langKey);\n    }\n\n    /** Set new lang by string key from languages class field\n    @param langKey<String>\n    */\n    setLang(langKey) {\n        const newLanguage = this.#languages[langKey];\n        const oldLanguage = this.#currentLanguage;\n\n        if (!newLanguage) {\n            if (this.#isDebug) {\n                console.error(\n                    `Lieu | Language key \"${langKey}\" not found in languages!`\n                );\n            }\n\n            return;\n        }\n\n        this.#currentLanguage = newLanguage;\n        window.localStorage?.setItem(STORAGE_KEY, langKey);\n\n        this.#localizeDomElems();\n\n        if (this.#isPluginInitialized) {\n            this.#onSetLang(oldLanguage, newLanguage);\n        } else {\n            this.#isPluginInitialized = true;\n        }\n    }\n\n    // Find all data-attributes by attributeName field in DOM, and localize them\n    #localizeDomElems() {\n        const localeElems = Array.from(\n            document.querySelectorAll(`[${this.#attributeName}]`)\n        );\n\n        const { locales } = this.#currentLanguage;\n\n        localeElems.forEach((elem) => {\n            const locale = elem.getAttribute(this.#attributeName);\n\n            let localeText = locales[locale];\n\n            // If not found set attr value as text\n            if (!localeText) {\n                localeText = locale;\n\n                if (this.#isDebug) {\n                    console.warn(\n                        `Lieu | ${\n                            this.#attributeName\n                        } attribute value \"${locale}\" not found in current language!`\n                    );\n                }\n            }\n\n            elem.innerHTML = localeText;\n        });\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    localize(localeKey) {\n        const { locales } = this.#currentLanguage;\n        let locale = locales[localeKey];\n\n        if (!locale) {\n            locale = localeKey;\n\n            if (this.#isDebug) {\n                console.error(\n                    `Lieu | Locale key \"${localeKey}\" not found in current language!`\n                );\n            }\n        }\n\n        return locale;\n    }\n\n    /** Return value from currentLanguage.locales or null\n    @param localeKey<String>\n    */\n    __(localeKey) {\n        return this.localize(localeKey);\n    }\n\n    // Return browser language\n    getBrowserLang() {\n        return navigator?.language;\n    }\n\n    /** Return language object from languages class field by its' key\n    * or current langauge if @param langKey is not set\n    @param langKey<String> not required\n    */\n    getLang(langKey) {\n        this.#onGetLang();\n\n        if (langKey) {\n            return this.#languages[langKey];\n        }\n\n        return this.#currentLanguage;\n    }\n\n    // Returns object of all languages\n    getLangs() {\n        return this.#languages;\n    }\n\n    // Returns string of initial language\n    getInitialLang() {\n        return this.#initialLanguage;\n    }\n}\n"],"names":["Helpers","isObject","obj","isFunction","fromJson","languagesFromJson","JSON","parse","STORAGE_KEY","ATTRIBUTE_NAME","Lieu","newLang","oldLang","constructor","initialData","isDebug","initialLanguages","languages","onSetLang","onGetLang","attr","attributeName","langs","storageLangKey","window","localStorage","getItem","initialLangName","initialLanguage","defaultLangKey","isExistsInLangs","browserLang","getBrowserLang","slice","Object","keys","setLang","langKey","langKeys","find","key","newLanguage","oldLanguage","console","error","setItem","localeElems","Array","from","document","querySelectorAll","locales","forEach","elem","locale","getAttribute","localeText","warn","innerHTML","localize","localeKey","__","navigator","language","getLang","getLangs","getInitialLang"],"mappings":"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"}