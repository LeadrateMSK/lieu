{"version":3,"file":"lieu.js","sources":["../src/core/Helpers.js","../src/core/const.js","../src/core/index.js"],"sourcesContent":["class Helpers {\n    // Checks if passed object is object or not\n    static isObject(obj) {\n        return typeof obj === 'object';\n    }\n\n    // Checks if passed object is funcion or not\n    static isFunction(obj) {\n        return typeof obj === 'function';\n    }\n\n    /** Returns parsed from JSON object or null\n    @param obj<JSON>\n    */\n    static fromJson(obj) {\n        try {\n            const languagesFromJson = JSON.parse(obj);\n\n            if (this.isObject(languagesFromJson)) {\n                return languagesFromJson;\n            } else {\n                return null;\n            }\n        } catch {\n            return null;\n        }\n    }\n}\n\nexport default Helpers;\n","const STORAGE_KEY = 'lieu';\nconst ATTRIBUTE_NAME = 'data-lieu';\n\nexport { STORAGE_KEY, ATTRIBUTE_NAME };\n","import Helpers from './Helpers';\r\nimport { STORAGE_KEY, ATTRIBUTE_NAME } from './const';\r\n\r\n/**\r\n * @param initialData<Object>\r\n */\r\nexport default class Lieu {\r\n    #initialData = null; // object\r\n    #languages = null; // object\r\n    #currentLanguage = null; // object\r\n    #initialLanguage = null; // string\r\n    #attributeName = ATTRIBUTE_NAME; // string\r\n\r\n    #onSetLang = (newLang, oldLang) => {};\r\n    #onGetLang = () => {};\r\n\r\n    constructor(initialData) {\r\n        this.#initialData = initialData;\r\n\r\n        this.#initLieu();\r\n    }\r\n\r\n    // Class initialization\r\n    #initLieu() {\r\n        this.#initLanguages();\r\n        this.#setHooks();\r\n        this.#setAttributeName();\r\n        this.#setInitialLanguage();\r\n    }\r\n\r\n    // Set class field languages if languages from inittial data is object or json\r\n    #initLanguages() {\r\n        let initialLanguages = this.#initialData?.languages;\r\n\r\n        if (Helpers.isObject(initialLanguages)) {\r\n            this.#setLanguages(initialLanguages);\r\n        } else {\r\n            initialLanguages = Helpers.fromJson(initialLanguages); // return null if lang not in json\r\n\r\n            this.#setLanguages(initialLanguages);\r\n        }\r\n    }\r\n\r\n    // Set hooks if they exist in inital data\r\n    #setHooks() {\r\n        if (Helpers.isFunction(this.#initialData.onSetLang)) {\r\n            this.#onSetLang = this.#initialData.onSetLang;\r\n        }\r\n\r\n        if (Helpers.isFunction(this.#initialData.onGetLang)) {\r\n            this.#onGetLang = this.#initialData.onGetLang;\r\n        }\r\n    }\r\n\r\n    // Set custom data attribute\r\n    #setAttributeName() {\r\n        const attr = this.#initialData?.attributeName;\r\n\r\n        if (attr) {\r\n            this.#attributeName = attr;\r\n        }\r\n    }\r\n\r\n    /** Set languages from initial data in languages class field\r\n    @param langs<Object>\r\n    */\r\n    #setLanguages(langs) {\r\n        this.#languages = langs;\r\n    }\r\n\r\n    // Set initial language from languages\r\n    #setInitialLanguage() {\r\n        const langKeys = Object.keys(this.#languages);\r\n        const initialLangName = this.#initialData.initialLanguage;\r\n\r\n        if (initialLangName) {\r\n            for (let i = 0; i < langKeys.length; i++) {\r\n                if (initialLangName.includes(langKeys[i])) {\r\n                    this.#initialLanguage = initialLangName;\r\n\r\n                    this.setLang(initialLangName);\r\n\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            this.#setInitialLanguageAuto();\r\n        }\r\n    }\r\n\r\n    // Set initial language if initial language is not set in initial data\r\n    #setInitialLanguageAuto() {\r\n        // Todo improve\r\n        const storageLangKey = window.localStorage?.getItem(STORAGE_KEY);\r\n        const langKeys = Object.keys(this.#languages);\r\n        let langKey = langKeys[0];\r\n\r\n        if (storageLangKey) {\r\n            for (let i = 0; i < langKeys.length; i++) {\r\n                if (langKeys[i] === storageLangKey) {\r\n                    langKey = storageLangKey;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        this.#initialLanguage = langKey;\r\n\r\n        this.setLang(langKey);\r\n    }\r\n\r\n    /** Set new lang by string key from languages class field\r\n    @param langKey<String>\r\n    */\r\n    setLang(langKey) {\r\n        const oldLang = this.#currentLanguage;\r\n\r\n        this.#currentLanguage = this.#languages[langKey];\r\n        window.localStorage?.setItem(STORAGE_KEY, langKey);\r\n\r\n        this.#localizeDomElems();\r\n\r\n        this.#onSetLang(oldLang, this.#currentLanguage);\r\n    }\r\n\r\n    // Find all data-attributes by attributeName field in DOM, and localize them\r\n    #localizeDomElems() {\r\n        const localeElems = Array.from(\r\n            document.querySelectorAll(`[${this.#attributeName}]`)\r\n        );\r\n\r\n        const { locales } = this.#currentLanguage;\r\n\r\n        localeElems.forEach((elem) => {\r\n            const locale = elem.getAttribute(this.#attributeName);\r\n\r\n            const localeText = locales[locale];\r\n\r\n            elem.innerHTML = localeText;\r\n        });\r\n    }\r\n\r\n    /** Return value from currentLanguage.locales or null\r\n    @param localeKey<String>\r\n    */\r\n    localize(localeKey) {\r\n        const { locales } = this.#currentLanguage;\r\n\r\n        return locales[localeKey];\r\n    }\r\n\r\n    /** Return value from currentLanguage.locales or null\r\n    @param localeKey<String>\r\n    */\r\n    __(localeKey) {\r\n        return this.localize(localeKey);\r\n    }\r\n\r\n    // Return browser language\r\n    getBrowserLang() {\r\n        return navigator?.language;\r\n    }\r\n\r\n    /** Return language object from languages class field by its' key\r\n    * or current langauge if @param langKey is not set\r\n    @param langKey<String> not required\r\n    */\r\n    getLang(langKey) {\r\n        this.#onGetLang();\r\n\r\n        if (langKey) {\r\n            return this.#languages[langKey];\r\n        }\r\n\r\n        return this.#currentLanguage;\r\n    }\r\n\r\n    // Returns object of all languages\r\n    getLangs() {\r\n        return this.#languages;\r\n    }\r\n\r\n    // Returns string of initial language\r\n    getInitialLang() {\r\n        return this.#initialLanguage;\r\n    }\r\n}\r\n"],"names":["Helpers","isObject","obj","isFunction","fromJson","languagesFromJson","JSON","parse","STORAGE_KEY","ATTRIBUTE_NAME","Lieu","newLang","oldLang","constructor","initialData","initialLanguages","languages","onSetLang","onGetLang","attr","attributeName","langs","langKeys","Object","keys","initialLangName","initialLanguage","i","length","includes","setLang","storageLangKey","window","localStorage","getItem","langKey","setItem","localeElems","Array","from","document","querySelectorAll","locales","forEach","elem","locale","getAttribute","localeText","innerHTML","localize","localeKey","__","getBrowserLang","navigator","language","getLang","getLangs","getInitialLang"],"mappings":"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"}